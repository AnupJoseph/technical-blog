<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:media="http://search.yahoo.com/mrss/"><channel><title><![CDATA[Explorations]]></title><description><![CDATA[Thoughts, stories, ideas and whatever other random thing came to my mind.]]></description><link>https://anup-blog.netlify.app/</link><image><url>https://anup-blog.netlify.app/favicon.png</url><title>Explorations</title><link>https://anup-blog.netlify.app/</link></image><generator>Ghost 4.16</generator><lastBuildDate>Tue, 05 Oct 2021 04:23:41 GMT</lastBuildDate><atom:link href="https://anup-blog.netlify.app/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Recreating a Bar Chart Design in Python]]></title><description><![CDATA[Learn to design a stylish bar chart in Python]]></description><link>https://anup-blog.netlify.app/recreating-a-bar-chart-design-in-python/</link><guid isPermaLink="false">6155468a2ec9c014bf83c68e</guid><category><![CDATA[Python]]></category><dc:creator><![CDATA[Anup Joseph]]></dc:creator><pubDate>Sun, 03 Oct 2021 13:22:38 GMT</pubDate><media:content url="https://anup-blog.netlify.app/content/images/2021/10/1_T5v47mcspkYIcfkrLu9GTw-1.png" medium="image"/><content:encoded><![CDATA[<img src="https://anup-blog.netlify.app/content/images/2021/10/1_T5v47mcspkYIcfkrLu9GTw-1.png" alt="Recreating a Bar Chart Design in Python"><p><em><em>Credits to </em></em><a href="https://www.linkedin.com/in/alenkagucek/" rel="noopener ugc nofollow"><em><em>Alenka Gucek</em></em></a><em><em> for her orginal design</em></em></p><hr><p>Recently, the Data visualization Stockholm(DVS) meetup group held their first datavis challenge. The dataset for the challenge was snow depth and temperature data from early 20th century to January 2021. The only design constraint was that the visualization had to be black and white.</p><figure class="kg-card kg-gallery-card kg-width-wide kg-card-hascaption"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/1_Z4z5TROLKSZ3byzMHSjpgQ.png" width="563" height="294" loading="lazy" alt="Recreating a Bar Chart Design in Python"></div><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/1_MTReQUAp6a1Pe_RkP6Na1Q.png" width="700" height="1312" loading="lazy" alt="Recreating a Bar Chart Design in Python" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/1_MTReQUAp6a1Pe_RkP6Na1Q.png 600w, https://anup-blog.netlify.app/content/images/2021/09/1_MTReQUAp6a1Pe_RkP6Na1Q.png 700w"></div><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/1_T5v47mcspkYIcfkrLu9GTw.png" width="1596" height="1204" loading="lazy" alt="Recreating a Bar Chart Design in Python" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/1_T5v47mcspkYIcfkrLu9GTw.png 600w, https://anup-blog.netlify.app/content/images/size/w1000/2021/09/1_T5v47mcspkYIcfkrLu9GTw.png 1000w, https://anup-blog.netlify.app/content/images/2021/09/1_T5v47mcspkYIcfkrLu9GTw.png 1596w" sizes="(min-width: 720px) 720px"></div></div><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/image-1.png" width="1509" height="952" loading="lazy" alt="Recreating a Bar Chart Design in Python" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/image-1.png 600w, https://anup-blog.netlify.app/content/images/size/w1000/2021/09/image-1.png 1000w, https://anup-blog.netlify.app/content/images/2021/09/image-1.png 1509w" sizes="(min-width: 720px) 720px"></div><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/1_yJbTXrCMUSBaRpVVt0-ryw.jpeg" width="700" height="429" loading="lazy" alt="Recreating a Bar Chart Design in Python" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/1_yJbTXrCMUSBaRpVVt0-ryw.jpeg 600w, https://anup-blog.netlify.app/content/images/2021/09/1_yJbTXrCMUSBaRpVVt0-ryw.jpeg 700w"></div></div></div><figcaption>Submissions in the Stockholm contest</figcaption></figure><p>The challenge received an amazing variety of great submissions. You can read more about them <a href="https://medium.com/data-visualization-stockholm/data-viz-challenge-1-a288142e8006" rel="noopener">here</a>.</p><p>All of these designs are frankly magnificent. However one design among these stood out to me for its simplicity and elegance. This design was made by <a href="https://twitter.com/alenka_gucek" rel="noopener ugc nofollow">Alenka Gucek</a>, a postdoc researcher at Uppsala university</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://anup-blog.netlify.app/content/images/2021/09/image-2.png" class="kg-image" alt="Recreating a Bar Chart Design in Python" loading="lazy" width="1509" height="952" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/image-2.png 600w, https://anup-blog.netlify.app/content/images/size/w1000/2021/09/image-2.png 1000w, https://anup-blog.netlify.app/content/images/2021/09/image-2.png 1509w" sizes="(min-width: 720px) 720px"><figcaption>Alenka Gucek&#x2019;s design</figcaption></figure><p>I felt that the most important part of this design is its focus on minimalism and its reusability. This design and its variations in color can be used in a variety of places, essentially wherever bar charts are used. It conveys the information accurately and is interesting and visually pleasing at the same time. Keeping this in mind, I decided to recreate this design as closely as possible. I have tried to make this chart as &#x201C;templatey&#x201D; as possible.</p><p>The original design was done in the far fortresses of Excel, Orgin and CorelDraw. I had little to zero knowledge of these tools and so I decided to recreate this plot in Python using the Plotly library.</p><figure class="kg-card kg-gallery-card kg-width-wide"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/image-3.png" width="663" height="453" loading="lazy" alt="Recreating a Bar Chart Design in Python" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/image-3.png 600w, https://anup-blog.netlify.app/content/images/2021/09/image-3.png 663w"></div><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/image-4.png" width="663" height="453" loading="lazy" alt="Recreating a Bar Chart Design in Python" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/image-4.png 600w, https://anup-blog.netlify.app/content/images/2021/09/image-4.png 663w"></div><div class="kg-gallery-image"><img src="https://anup-blog.netlify.app/content/images/2021/09/image-5.png" width="663" height="453" loading="lazy" alt="Recreating a Bar Chart Design in Python" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/image-5.png 600w, https://anup-blog.netlify.app/content/images/2021/09/image-5.png 663w"></div></div></div></figure><p>Now the de facto library for creating visualizations with python is matplotlib. However, I personally find matplotlib a bit unrewarding and kind of overwhelming, so I prefer to use plotly. It has built in interactivity and the overall visual as well as developer experience is great. While not as powerful as matplotlib, its quite good and its almost too easy to get started.</p><p>Here the link to the google colaboratory interactive Jupyter environment and this is the link to the <a href="https://github.com/AnupJoseph/plotly_bar_chart" rel="noopener ugc nofollow">github repo</a>.</p><p></p><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://colab.research.google.com/drive/1_DcUOargym-RBgLQfXN0NjXOOCrJa_mT?usp=sharing"><div class="kg-bookmark-content"><div class="kg-bookmark-title">Google Colaboratory</div><div class="kg-bookmark-description"></div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://colab.research.google.com/img/favicon.ico?vrz=colab-20210928-060101-RC00_399406659" alt="Recreating a Bar Chart Design in Python"></div></div><div class="kg-bookmark-thumbnail"><img src="https://colab.research.google.com/img/colab_favicon_256px.png" alt="Recreating a Bar Chart Design in Python"></div></a></figure><p>To get started lets import the python data science essential libraries, numpy and pandas.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/d8d09a2e2cd29d5483d3a978436ed62c.js"></script><!--kg-card-end: html--><p>I have also added the datetime libraries and of course, plotly itself.</p><p>The dataset for the challenge can be found in <a href="https://github.com/Dataviz-Stockholm/challenges" rel="noopener ugc nofollow">this repository</a>. Lets import the data and have a look at it. Since by looking at the data on github we already know that the dataset has a time column, I am adding a parse_dates arguement.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/588b60a7e058ab7cb26e6d6c961af0a6.js"></script><!--kg-card-end: html--><p>Running a unique check we find that there are some bad values in the dataset which need to be cleaned up.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/146fa3dc644184edc299a11d0c7a373b.js"></script><!--kg-card-end: html--><p>Now admittedly since we are interested in the maximum value of the Snow depth the deviations like &#x201C;-00.02.00&#x201D; won&#x2019;t matter much and simply dropping them won&#x2019;t cause a lot of trouble. But that&#x2019;s not really a good practice.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/e9cf630bf142d009cd038eaf33fb9a83.js"></script><!--kg-card-end: html--><p>Next, let&#x2019;s convert the &#x201C;Snow&#x201D; column into floats. Since we are interested in the yearly maximum snow depth lets group the dataset in years and find out the maximum snow depth in each year.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/bb97cb277370b93b52f896ab45b7bcca.js"></script><!--kg-card-end: html--><p>This is the data we need to plot. Now plotly has a system of traces for plotting. Each individual trace is a small component like a<a href="https://plotly.com/python/line-and-scatter/" rel="noopener ugc nofollow"> scatter of points</a> or a <a href="https://plotly.com/python/bar-charts/" rel="noopener ugc nofollow">bar</a>. These components are collectively available under plotly.<a href="https://plotly.com/python/graph-objects/" rel="noopener ugc nofollow">graph_objects</a> and can be combined to create interactive and useful charts.</p><hr><p>My first plan was to use bar charts to make this visualization, specifically the go.Bar class and somehow make the adjacent lines of the bar chart disappear. I quickly realized that this was a terrible plan and plotly doesn&#x2019;t even allow this to be done. My second idea was to create a scatterplot and join them using lines. This is kind of counter-intuitive and takes a second to wrap your head around it. Imagine it like this,</p><ul><li>A scatterplot has collection of points representing datapoints.</li><li>Now instead of having points, turn each point into small line with a small length.</li><li>Seperate each point by the given length.</li><li>Then join them all together vertically to give an impression of bars.</li></ul><p>Now to make any scatterplot we need two dimensions x and y. We will build y co-ordinates first and then create the corresponding x co-ordinates.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/6d0f8929da70d38c174c854017fa340d.js"></script><!--kg-card-end: html--><p>Since, this is a scatterplot pretending to be a bar chart we need to have two values of each maximum snow depth (Remember the dots getting width thing I rattled off before?). Next we use these y co-ordinates to build our x co-ordinates. I have chosen a width of 5 for each bars but feel free to choose any other.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/fa9e9dc1c3e3c4dfc0781a4ac198304f.js"></script><!--kg-card-end: html--><p>Finally our long setup process it done. Lets get started on plotting. We will add one trace of scatterplots with our x and y co-ordinates and set the mode to lines. Plotly will then join each co-ordinate for us. Keeping the in the black and white theme of the challenge lets make the line white and the background dark.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/0e048fd75498e45ed20f6e7aeec76372.js"></script><!--kg-card-end: html--><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://anup-blog.netlify.app/content/images/2021/10/image.png" class="kg-image" alt="Recreating a Bar Chart Design in Python" loading="lazy" width="700" height="295" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/10/image.png 600w, https://anup-blog.netlify.app/content/images/2021/10/image.png 700w"><figcaption>basic plot</figcaption></figure><p>This is what our plot looks like at the moment. We are already quite a long way there. For now lets add a title to the plot and remove the grid and axes.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/1d1d832c745433aa652b5c490887593d.js"></script><!--kg-card-end: html--><figure class="kg-card kg-image-card"><img src="https://anup-blog.netlify.app/content/images/2021/10/image-1.png" class="kg-image" alt="Recreating a Bar Chart Design in Python" loading="lazy" width="700" height="295" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/10/image-1.png 600w, https://anup-blog.netlify.app/content/images/2021/10/image-1.png 700w"></figure><p>The last additions to our plots are the xaxis and yaxis labels. Here plotly&#x2019;s interactive components come into play.</p><ul><li>Choose the years you want to annotate.</li><li>Find the snow_depth at those years. The snow_max variable will help in this.</li><li>Hover over the graph and find out the snow_depth of your chosen years. Note the corresponding xaxis values in the tooltip.</li><li>Pass these xaxis values to your tickvals variable</li></ul><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/fe017b9fa9743d37a4e38c1de9e8f0ed.js"></script><!--kg-card-end: html--><figure class="kg-card kg-image-card"><img src="https://anup-blog.netlify.app/content/images/2021/10/image-2.png" class="kg-image" alt="Recreating a Bar Chart Design in Python" loading="lazy" width="700" height="295" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/10/image-2.png 600w, https://anup-blog.netlify.app/content/images/2021/10/image-2.png 700w"></figure><p>We need to fix up the tooltip in the graph. At the moment it shows the actual X and Y axis values of the graph on the tooltip. To change that we need to create a array of values we want to display. For every even index in the x_axis let&#x2019;s add the corresponding years twice.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/71f6382f9eb165b3f0cde694ae8d3458.js"></script><!--kg-card-end: html--><p>The last things left on the plot are annotations. I am deliberately not annotating everything in the plot. However I&#x2019;ll add an example here.</p><!--kg-card-begin: html--><script src="https://gist.github.com/AnupJoseph/cfa57f7ea867ad33716673accf9bc43d.js"></script><!--kg-card-end: html--><p>Here&#x2019;s the final interactive version of the plot.</p><p>So that&#x2019;s all for today. Hope you had as much fun reading the tutorial as I had writing it.</p><p>Thanks to <a href="https://medium.com/@sam99dave" rel="noopener">Samuel Davis</a> and <a href="https://www.linkedin.com/in/darlene-nazareth-b08bb9192/" rel="noopener ugc nofollow">Darlene Nazerath</a> for helping with reviewing the the article and testing the code.<br>Feel free to connect with me on <a href="https://www.linkedin.com/in/anup-joseph/" rel="noopener ugc nofollow">LinkedIn</a>.</p><p></p><p></p><p><br></p><p></p><p></p><p></p><p></p><p></p>]]></content:encoded></item><item><title><![CDATA[Opening Resnets]]></title><description><![CDATA[<p><strong><em>Step by step exploration on what happens to an image in Resnets</em></strong></p><p>Residual Networks(Resnets from here on) were introduced by Kaiming He, Xiangyu Zhang, Shaoqing Ren and Jian Sun of Microsoft Research in their seminal paper - <a href="https://arxiv.org/pdf/1512.03385.pdf">Deep Residual Learning for Image Recognition</a>. Resnets effectively solves the vanishing gradient</p>]]></description><link>https://anup-blog.netlify.app/unlocking-resnets/</link><guid isPermaLink="false">614410e54298b8193f10a668</guid><category><![CDATA[Deep Learning]]></category><dc:creator><![CDATA[Anup Joseph]]></dc:creator><pubDate>Thu, 30 Sep 2021 05:26:00 GMT</pubDate><media:content url="https://anup-blog.netlify.app/content/images/2021/09/resnet.png" medium="image"/><content:encoded><![CDATA[<img src="https://anup-blog.netlify.app/content/images/2021/09/resnet.png" alt="Opening Resnets"><p><strong><em>Step by step exploration on what happens to an image in Resnets</em></strong></p><p>Residual Networks(Resnets from here on) were introduced by Kaiming He, Xiangyu Zhang, Shaoqing Ren and Jian Sun of Microsoft Research in their seminal paper - <a href="https://arxiv.org/pdf/1512.03385.pdf">Deep Residual Learning for Image Recognition</a>. Resnets effectively solves the vanishing gradient problem for deep networks and the ideas they introduced have been used in multiple architectures from there on. </p><p>In a recent assignment I was tasked with understanding how Resnets worked and present the same. I was curious to know what actually happened to an image in Resnet and tried to work out the same. This blog post is the result of that experiment and tries to illustrate the various calculations that happen inside the Resnet architecture.</p><p><em>Before we begin, I am almost certain that this article will have mistakes. I have tried my best to eliminate them. However if you do find any mistake please let me know in the comment or mail personally <a href="mailto:anup20joseph@gmail.com">here</a> and I will fix them as soon as possible.</em></p><figure class="kg-card kg-image-card kg-width-wide kg-card-hascaption"><img src="https://anup-blog.netlify.app/content/images/2021/09/network.png" class="kg-image" alt="Opening Resnets" loading="lazy" width="614" height="276" srcset="https://anup-blog.netlify.app/content/images/size/w600/2021/09/network.png 600w, https://anup-blog.netlify.app/content/images/2021/09/network.png 614w"><figcaption>Resnet architectures</figcaption></figure><p>The Resnet paper, &#xA0;quite helpfully provides this diagram dividing the network into blocks and showing the output sizes of each block. However this picture might give idea that stride is common through the network from block 2 to 5, which is not the case. We also need to look at the Resnet 34 network given in the paper.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://anup-blog.netlify.app/content/images/2021/09/Architecture-Resnet-34.png" class="kg-image" alt="Opening Resnets" loading="lazy" width="86" height="539"><figcaption>Resnet 34 architecture with residual connections</figcaption></figure><p>This image adds crucial information about strides missing in the earlier image. However this does not have the concise block structures of the earlier image, so I suggest to keep them both at hand. There is one more important bit of information useful in computing the image size. The paper expresses this as </p><p><em>we use identity mapping for all shortcuts and zero-padding for increasing dimensions.</em></p><p>However, I feel that this bit of Python in the (old)Tensorflow implementation of Resnet is a bit more helpful.</p><pre><code class="language-python">padding=(&apos;SAME&apos; if strides == 1 else &apos;VALID&apos;)</code></pre><p>This acts as a nice rule for computing through the architecture after block 1 without having to think it through every time. For people wondering what is <em>padding=&quot;SAME&quot; </em>and <em>padding=&quot;VALID&quot; </em>try this <a href="https://stackoverflow.com/questions/37674306/what-is-the-difference-between-same-and-valid-padding-in-tf-nn-max-pool-of-t">link</a>. Armed with all that info, lets get to work.</p><p>Input image size - (224,224,3)</p><h3 id="block-1-conv1">Block 1: conv1</h3><p>Layer 1: Convolution(filters=64, kernel_size=7x7, strides=2)</p><p>To calculate the output size in a convolution layer we use this formula:</p><!--kg-card-begin: html--><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 542 80" width="542" height="80">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="542" height="80" fill="#ffffff"/><g transform="translate(10 20) rotate(0 76.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">output_size = </text></g><g transform="translate(171 10) rotate(0 155 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">input - kernel_size + 2*padding</text></g><g stroke-linecap="round"><g transform="translate(167 35) rotate(0 158.86764805005396 0.6714253277797297)"><path d="M-0.1 0.54 C53.29 0.71, 266.12 0.33, 319.35 0.37 M-1.61 -0.23 C51.73 0.16, 265.21 1.21, 318.58 1.57" stroke="#000000" stroke-width="1" fill="none"/></g></g><g transform="translate(504 24) rotate(0 14 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">+ 1</text></g><g transform="translate(318 45) rotate(0 28.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">stride</text></g></svg><!--kg-card-end: html--><p>For the first input the above rule does not apply instead the padding is 2.</p><p>Output size = (224 - 7 + 2 * 2) / 2 + 1 = 111.5 &#x2248; 112.															</p><p>Final output size of this block = (112x112x64)</p><h3 id="block-2-conv2x">Block 2: conv2_x</h3><p>Layer 1: Maxpool(kernel_size=3x3, strides=2)</p><p>To calculate the output size in a maxpool layer we use this formula</p><!--kg-card-begin: html--><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 407 80" width="407" height="80">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style>
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="407" height="80" fill="#ffffff"/><g transform="translate(10 20) rotate(0 76.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">output_size = </text></g><g transform="translate(171 10) rotate(0 91.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">input - kernel_size</text></g><g stroke-linecap="round"><g transform="translate(167 35) rotate(0 96.54208162748716 0.4570427794335501)"><path d="M-0.1 0.54 C32.51 0.64, 162.25 -0.03, 194.7 -0.06 M-1.61 -0.23 C30.96 0.08, 161.33 0.85, 193.93 1.14" stroke="#000000" stroke-width="1" fill="none"/></g></g><g transform="translate(369 24) rotate(0 14 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">+ 1</text></g><g transform="translate(218 45) rotate(0 28.5 12.5)"><text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr">stride</text></g></svg><!--kg-card-end: html--><p>Output size = (112 - 3) / 2+ 1 = 56																				</p><p>Output size = (56x56x64)</p><p>Layer 2: Convolution(filters=64, kernel_size=3x3, strides=1)</p><p>Output size = (56 - 3 + 2 x 1 ) / 1 + 1 = 55.5 &#x2248; 56</p><p>Output size = (56x6x64)</p><p>There are 5 more Convolution(filters=64, kernel_size=3x3, strides=1) layers. As you can see from the above calculation this does not downsample the image and hence the output size remains the size. Hence the output from this block is (56x56x64).</p><h3 id="block-3-conv3x">Block 3: conv3_x</h3><p>Layer 1: Convolution(filters=128, kernel_size=3x3, strides=2)</p><p>Output size = (56 - 3 + 2 x 0) / 2 + 1 = 27.5 &#x2248; 28</p><p>Output size = (28x28x128)</p><p>Layer 2: Convolution(filters=128, kernel_size=3x3, strides=1)</p><p>Output size = (28 - 3 + 2 x 1) / 1 + 1 = 28</p><p>Output size = (28x28x128)</p><p>There are 6 more Convolution(filters=128, kernel_size=3x3, strides=1) layers. Again this does not downsample the image and hence the output size remains the size. Hence the output from this block is (28x28x128).</p><h3 id="block-4-conv4x">Block 4: conv4_x</h3><p>Layer 1: Convolution(filters=256, kernel_size=3x3, strides=2)</p><p>Output size = (28 - 3 + 2 x 0) / 2 + 1 = 13.5 &#x2248; 14</p><p>Output size = (14x14x256)</p><p>Layer 2: Convolution(filters=256, kernel_size=3x3, strides=1)</p><p>Output size = (14 - 3 + 2 x 1) / 1 + 1 = 14</p><p>Output size = (14x14x256)</p><p>There are 10 more Convolution(filters=256, kernel_size=3x3, strides=1) layers. And like above the output size remains the same. So final output size = (14x14x256).</p><h3 id="block-5-conv5x">Block 5: conv5_x</h3><p>Layer 1: Convolution(filters=512, kernel_size=3x3, strides=2)</p><p>Output size = (14 - 3 + 2 x 0) / 2 + 1 = 6.5 &#x2248; 7</p><p>Output size = (7x7x512)</p><p>Layer 2: Convolution(filters=512, kernel_size=3x3, strides=1)</p><p>Output size = (7 - 3 + 2x1)/1 +1 = 7</p><p>Output size = (7x7x512)</p><p>There are 4 more Convolution(filters=512, kernel_size=3x3, strides=1) layers. And like above the output size remains the same. So final output size = (7x7x512).</p><h3 id="block-5-conv5x-1">Block 5: conv5_x</h3><p>Global average pool is essentially a large classifier which converts the 7x7x512 layer into 1x1x1000 as the Resnet is trained on the ImageNet dataset which has a thousand classes.</p><!--kg-card-begin: html--><script src="https://utteranc.es/client.js" repo="[ENTER REPO HERE]" issue-term="pathname" label="blog-question" theme="dark-blue" crossorigin="anonymous" async>
</script><!--kg-card-end: html-->]]></content:encoded></item></channel></rss>